(function(window){function MdTOCNav(option){this._init(option);this._do()}MdTOCNav.prototype={_init:function(option){this.el=option&&option.el||"main";this.rootArea=document.getElementById(this.el)||document.body;this.allNodes=[];this.level=option&&option.level&&option.level>1&&option.level<7||3;this.tocDataArr=[];this.newTocData={};this.levelBoolean=["H2","H3","H4","H5","H6"];this.levelCount=[0,0,0,0,0];this.levelBoolean=this.levelBoolean.slice(0,this.level-1);this.tocLiHtmls="";this.newTocLiHtml="";this.styles=option&&option.style||"#mdTocNav{position:fixed;top:50px;left:10px;width:200px;height:500px;overflow-x:hidden;overflow-y:auto;border-radius:.5em;background:#eee;list-style-type:none;padding:10px}#mdTocNav li{line-height:1.8}.mdh2{padding:.2em 0 0}.mdh3{padding:0 .5em}.mdh4{padding:0 1em}.mdh5{padding:0 1.5em}.mdh6{padding:0 2em}#mdTocNav a{color:#666;text-decoration:none;border-bottom:1px solid #ccc}.mdh2 a{color:#333}.nav-number{margin-right:.5em;color:#999}.mdh2 .nav-number{margin-right:.8em}span.nav-text{white-space:nowrap}"},_traverseNodes:function(){var that=this;function tn(node){if(node.hasChildNodes){var cNodes=node.children;for(var i=0;i<cNodes.length;i++){that.allNodes.push(cNodes[i]);tn(cNodes[i])}}}tn(this.rootArea)},_createTocArr:function(){for(var i=0;i<this.allNodes.length;i++){var tagName=this.allNodes[i].tagName;for(var x=0;x<this.levelBoolean.length;x++){if(this.levelBoolean[x]===tagName){var that=this;this.newTocData={className:"mdh"+(x+2),serialNum:(function(that){that.levelCount[x]++;that.levelCount.splice(x+1,that.levelCount.length-x-1,0,0,0,0,0);return that.levelCount.slice(0,x+1).join(".")})(that),targetId:"mdTocNav"+this.newTocData.serialNum,text:this.allNodes[i].innerText};this.tocDataArr.push(this.newTocData);this.allNodes[i].id+=(this.allNodes[i].id?" ":"")+this.newTocData.targetId}}}},_createNav:function(){for(var i=0;i<this.tocDataArr.length;i++){this.newTocLiHtml='<li class="'+this.tocDataArr[i].className+'">'+'<a href="#'+this.tocDataArr[i].targetId+'">'+'<span class="nav-number">'+this.tocDataArr[i].serialNum+"</span>"+'<span class="nav-text">'+this.tocDataArr[i].text+"</span>"+"</a>"+"</li>";this.tocLiHtmls+=this.newTocLiHtml}var mdTocNav=document.createElement("ol");mdTocNav.setAttribute("id","mdTocNav");mdTocNav.innerHTML=this.tocLiHtmls;document.body.appendChild(mdTocNav)},_addStyle:function(){var newStyle=document.createElement("style");newStyle.innerHTML=this.styles;document.getElementsByTagName("head")[0].appendChild(newStyle)},_do:function(){this._addStyle();this._traverseNodes();this._createTocArr();this._createNav()}};window.MdTOCNav=MdTOCNav;window.j_ready=function(fn){if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,false);fn()},false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",arguments.callee);fn()}})}}}})(window);